<div fxLayout="row" fxLayoutWrap="true">


  <div fxFlex.gt-sm="70" fxFlex="100" *ngIf="party != null" style="padding: 5px;">

    <div style="margin-bottom: 20px;">
      <mat-toolbar color="primary">
        <span>NOW PLAYING</span>
        <div fxLayoutAlign="end center" class="full-width">
          <button mat-raised-button color="accent">Leave party</button>
        </div>
      </mat-toolbar>

      <mat-card *ngIf="queue != null && queue.nowPlaying != null">
        <mat-card-content>
          <div fxLayout="row" fxLayoutGap="20px">
            <div class="now-playing-thumbnail"
                 [style.background-image]="getArtistThumbnail(queue.nowPlaying, true)"></div>
            <mat-list>
              <mat-list-item>
                <mat-icon mat-list-icon>music_note</mat-icon>
                <h4 mat-line> {{ queue.nowPlaying.title }}</h4>
                <p mat-line> {{ queue.nowPlaying.artist }}</p>
              </mat-list-item>
              <mat-list-item>
                <mat-icon mat-list-icon>person</mat-icon>
                <h4 mat-line>Requested by {{ queue.nowPlaying.member.displayName }}</h4>
              </mat-list-item>
              <mat-list-item>
                <mat-icon mat-list-icon>av_timer</mat-icon>
                <div mat-line>
                  <mat-progress-bar
                    color="primary"
                    mode="determinate"
                    [value]="calculateProgress(queue.nowPlaying)">
                  </mat-progress-bar>
                </div>
              </mat-list-item>
            </mat-list>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <div>
      <mat-toolbar color="primary">
        <span>QUEUE ({{ queue.entries.length }})</span>
      </mat-toolbar>

      <mat-card *ngIf="queue != null">
        <mat-card-content>

          <div fxLayout="column" fxLayoutAlign="center center" *ngIf="queue.entries.length == 0">
            <h1>The queue is empty</h1>
            <h2>Start by selecting a song using the search field above</h2>
          </div>

          <!--<mat-list>-->
          <table class="full-width">
            <thead>
            <tr>
              <th class="column-header">Song</th>
              <th class="column-header">Artist</th>
              <th class="column-header">Requested by</th>
              <th></th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let entry of queue.entries">
              <td>
                <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="20px">
                  <mat-icon mat-list-icon class="artist-thumbnail"
                            [style.background-image]="getArtistThumbnail(entry, true)"></mat-icon>
                  <span>{{ entry.title }}</span>
                </div>
              </td>
              <td>{{entry.artist }}</td>
              <td>{{ entry.member.displayName }}</td>
              <td>
                <div fxLayout="row" fxLayoutGap="10px">
                  <button mat-icon-button color="primary">
                    <mat-icon>thumb_up</mat-icon>
                    <span style="position: relative; top: 2px; left: 4px">{{entry.upvotes}}</span>
                  </button>

                  <button mat-icon-button color="danger">
                    <mat-icon>thumb_down</mat-icon>
                    <span style="position: relative; top: 2px; left: 4px">{{entry.downvotes}}</span>
                  </button>
                </div>
              </td>
            </tr>
            </tbody>
          </table>
          <!--<app-queue-list-item *ngFor="let entry of queue.entries" [entry]="entry"-->
          <!--class="typical-list-item"></app-queue-list-item>-->
          <!--</mat-list>-->
        </mat-card-content>
      </mat-card>

    </div>
  </div>


  <div fxFlex.gt-sm="30" fxFlex="100" *ngIf="party != null" style="padding: 5px;">
    <mat-toolbar color="primary">
      <span>Chat</span>
    </mat-toolbar>
    <mat-card style="height: 62vh; padding: 2px;">
      <mat-card-content class="chat-container">
        <div style="overflow: scroll; height: 100%;" #chatContainer [scrollTop]="chatContainer.scrollHeight">
          <mat-list>
            <mat-list-item style="padding: 0; margin: 0; height: 18px;" *ngFor="let message of messages">
              <span style="font-size: 13px; font-weight: bold;" [style.color]="getMessageColor(message)">
                {{message.sender}}</span><span style="font-size: 13px">: {{message.message | emojify}}</span>
            </mat-list-item>
          </mat-list>
        </div>
        <div class="send-chat-btn">
          <input mdInput class="chat-input" (keydown)="sendChatMessage($event)" #chatInput placeholder="Type to chat">
          <button mat-raised-button color="accent" [disabled]="!websocketAuthenticated" (click)="sendChatMessage()">
            Send
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

</div>
